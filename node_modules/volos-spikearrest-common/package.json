{
  "_args": [
    [
      {
        "raw": "volos-spikearrest-common@https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
        "scope": null,
        "escapedName": "volos-spikearrest-common",
        "name": "volos-spikearrest-common",
        "rawSpec": "https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
        "spec": "https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
        "type": "remote"
      },
      "/Users/sudheendras/Documents/sudhee/edgemicro/azure-microgateway"
    ]
  ],
  "_from": "volos-spikearrest-common@>=0.10.0 <0.11.0",
  "_id": "volos-spikearrest-common@0.10.3",
  "_inCache": true,
  "_location": "/volos-spikearrest-common",
  "_phantomChildren": {},
  "_requested": {
    "raw": "volos-spikearrest-common@https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
    "scope": null,
    "escapedName": "volos-spikearrest-common",
    "name": "volos-spikearrest-common",
    "rawSpec": "https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
    "spec": "https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
    "type": "remote"
  },
  "_requiredBy": [
    "/",
    "/volos-spikearrest-memory"
  ],
  "_resolved": "https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
  "_shasum": "d01f7b3590df8db7272eeffbd00da4136d11cfc6",
  "_shrinkwrap": null,
  "_spec": "volos-spikearrest-common@https://registry.npmjs.org/volos-spikearrest-common/-/volos-spikearrest-common-0.10.3.tgz",
  "_where": "/Users/sudheendras/Documents/sudhee/edgemicro/azure-microgateway",
  "bugs": {
    "url": "https://github.com/apigee/volos/issues"
  },
  "dependencies": {
    "debug": "^2.2.0",
    "underscore": "1.6.x"
  },
  "description": "Common library for Spike Arrest enforcement in the Volos system.",
  "devDependencies": {},
  "homepage": "https://github.com/apigee/volos",
  "keywords": [
    "spike arrest",
    "memory"
  ],
  "license": "MIT",
  "main": "lib/spikearrest.js",
  "name": "volos-spikearrest-common",
  "optionalDependencies": {},
  "readme": "# volos-spikearrest-common\n\nThis module adds support for Spike Arrest to any API.\n\nA Spike Arrest protects against traffic spikes. It throttles the number of requests processed by an API \nand sent to a backend, protecting against performance lags and downtime. Think of Spike Arrest as a way to generally \nprotect against traffic spikes rather than as a way to limit traffic to a specific number of requests. Your APIs \nand backend can handle a certain amount of traffic, and the Spike Arrest policy helps you smooth traffic to the \ngeneral amounts you want.\n\nTo prevent spike-like behavior, Spike Arrest calculates the allowed traffic into windows by dividing your settings into \nappropriate intervals:\n\n* Per-minute rates get smoothed into requests allowed intervals of seconds:\n\n    For example, 30 per minute gets smoothed like this:\n    60 seconds (1 minute) / 30pm = 2-second intervals, or about 1 request allowed every 2 seconds. A second request \n    inside of 2 seconds will fail if there is no buffer. Also, a 31st request within a minute will fail.\n\n* Per-second rates get smoothed into requests allowed in intervals of milliseconds.\n\n    For example, 10 per second gets smoothed like this:\n    1000 milliseconds (1 second) / 10ps = 100-millisecond intervals, or about 1 request allowed every 100 milliseconds. \n    A second request inside of 100ms will fail if there is no buffer. Also, an 11th request within a second will fail.\n\nIf the Spike Arrest is set up with a buffer (bufferSize > 0), however, it will not fail immediately when too many\nrequests are made concurrently. Instead, SpikeArrest will attempt to smooth requests by returning success to the caller\nonce the next appropriate execution window is available. Once the buffer is full, it will fail all further requests\nuntil a new execution window becomes available. \n\nUsing a buffer can be a great way to continue to fulfill requests during an quick, odd spike. However, be aware that \nwhen requests exceed the SpikeArrest window, this will delay responses up to: bufferSize * (timeUnit / allow).\n     \n    For example, 10 per second with a buffer of 10 means requests caught in the queue could be delayed up to 1 second!     \n\nYou create a Spike Arrest object with the following attributes:\n\n* timeUnit: How often the SpikeArrest resets - may be in seconds or minutes\n* allow: The maximum number of requests to allow during the timeUnit.\n* bufferSize: (optional, default = 0) if bufferSize > 0, SpikeArrest will attempt to smooth requests by returning only\n  when the next appropriate execution window is available.  bufferSize is how many requests to \"queue\" before returning\n  (immediately) with a isAllowed = false.\n\nOnce a Spike Arrest has been created, you \"apply\" the Spike Arrest by passing the following values:\n\n* weight: (optional, default = 1) How much to add to the Spike Arrest -- in some advanced cases, API providers may \n  want to assign different weights to different API calls.\n* key: (optional, default = '_default') Identifies the Spike Arrest bucket. This is a string that may be set to any value.\n  Each key locates a single bucket, which maintains separate windows from other buckets.\n\n## Modules\n\nThis module does not do anything on its own -- it depends on an implementation which stores the Spike Arrest in a \nparticular place. Currently the options are:\n\n* volos-spikearrest-memory: Stores Spike Arrest data in memory on the node where the script is running.\n\n## Example\n\n    var SpikeArrest = require('volos-spikearrest-memory');\n    var spikeArrest = SpikeArrest.create({\n      timeUnit: 'second',\n      allow: 10,\n      bufferSize: 10\n    });\n\n    spikeArrest.apply({ key: 'Foo', weight: 1 }, function(err, result) {\n      if (err) { return cb(err); }\n      console.log('Status: %s', result.isAllowed);\n    });\n\n## Reference\n\n### Class: SpikeArrest\n\n#### SpikeArrest.apply(options, callback)\n\nApply the SpikeArrest and invoke \"callback\" with a result. Options can have the following parameters:\n\n* weight: (optional, default = 1) How much to add to the Spike Arrest -- in some advanced cases, API providers may \n  want to assign different weights to different API calls.\n* key: (optional, default = '_default') Identifies the Spike Arrest bucket. This is a string that may be set to any value.\n  Each key locates a single bucket, which maintains separate windows from other buckets.\n\nThe result of this call is delivered by calling \"callback.\" If there was an error, then the first parameter\nwill be an Error object. Otherwise, the first parameter will be \"undefined\" and the second will be\nan object that contains the following fields:\n\n* allowed: (number) How much is allowed in the SpikeArrest bucket. Essentially the same as the \"allow\" parameter that is\npassed to the \"apply\" method, or the default that came from the overall object.\n* used: (number) How much of the SpikeArrest bucket is used up.\n* isAllowed: (boolean) Whether the SpikeArrest bucket has been used up. Basically the same as checking whether\n\"used > allowed\".\n* expiryTime: (number) The number of milliseconds until the SpikeArrest bucket \"used\" amount is reset to zero.\n\n### Middleware\n\n#### Middleware.apply(options)\n\nApplies SpikeArrest and returns (403) error on exceeded.\n\nOptions (optional) may contain:\n\n* key (optional) may be a string or a function that takes the request and generates a string id.\n* weight (optional) may be a number or a function that takes the request and generates a number\n\n\n#### Middleware usage examples: \n\n##### SpikeArrest.connectMiddleware()\n\nReturns middleware that may be used in a Connect server.\n\n```\n   server.get('/',\n     spikeArrest.connectMiddleware().apply(),\n     ...\n```\n \n##### SpikeArrest.expressMiddleware()\n\nReturns middleware that may be used in a Express server. \n\n```\n   server.get('/',\n     spikeArrest.expressMiddleware().apply(),\n     ...\n```\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/apigee/volos.git"
  },
  "version": "0.10.3"
}
